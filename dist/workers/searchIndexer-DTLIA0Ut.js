let o=null,t=null;const n=new Map;async function i(){if(!o)try{const e=await import("./index-JHxlRkRz.js");o=e.default||e}catch{o=self.FlexSearch}if(!o)throw new Error("FlexSearch not available in worker");t=new o.Index({tokenize:"forward",charset:"latin:extra",resolution:9,optimize:!0,minlength:2}),n.clear()}function l(e){if(!t){self.postMessage({type:"error",message:"Index not initialized"});return}try{t.add(e.id,e.text),n.set(e.id,{type:e.type,label:e.label,context:e.context,parent:e.parent}),self.postMessage({type:"added",id:e.id})}catch(s){self.postMessage({type:"error",action:"add",error:s.message})}}function c(e){if(!t){self.postMessage({type:"error",message:"Index not initialized"});return}try{const r=t.search(e.query,{limit:50,...e.options}).map(a=>({id:a,...n.get(a)})).filter(a=>a.id);self.postMessage({type:"search",query:e.query,results:r,count:r.length})}catch(s){self.postMessage({type:"error",action:"search",error:s.message})}}function p(e){if(!t){self.postMessage({type:"error",message:"Index not initialized"});return}try{t.remove(e.id),n.delete(e.id),self.postMessage({type:"removed",id:e.id})}catch(s){self.postMessage({type:"error",action:"remove",error:s.message})}}function d(){i().then(()=>{self.postMessage({type:"reset"})}).catch(e=>{self.postMessage({type:"error",action:"reset",error:e.message})})}function f(){if(!t){self.postMessage({type:"error",message:"Index not initialized"});return}self.postMessage({type:"stats",indexedItems:n.size,indexSize:t.length||n.size})}i().then(()=>{self.postMessage({type:"ready"})}).catch(e=>{self.postMessage({type:"error",action:"init",error:e.message})});self.onmessage=e=>{const{action:s,data:r}=e.data;switch(s){case"add":l(r);break;case"search":c(r);break;case"remove":p(r);break;case"reset":d();break;case"stats":f();break;default:self.postMessage({type:"error",message:`Unknown action: ${s}`})}};
